{
  "version": 3,
  "sources": ["../../in-viewport/in-viewport.js"],
  "sourcesContent": ["module.exports = inViewport;\n\nvar instances = [];\nvar supportsMutationObserver = typeof global.MutationObserver === 'function';\n\nfunction inViewport(elt, params, cb) {\n  var opts = {\n    container: global.document.body,\n    offset: 0,\n    debounce: 15,\n    failsafe: 150\n  };\n\n  if (params === undefined || typeof params === 'function') {\n    cb = params;\n    params = {};\n  }\n\n  var container = opts.container = params.container || opts.container;\n  var offset = opts.offset = params.offset || opts.offset;\n  var debounceValue = opts.debounce = params.debounce || opts.debounce;\n  var failsafe = opts.failsafe = params.failsafe || opts.failsafe;\n\n  // ensure backward compatibility with failsafe as boolean\n  if (failsafe === true) {\n    failsafe = 150;\n  } else if(failsafe === false) {\n    failsafe = 0;\n  }\n\n  // failsafe check always needs to be higher than debounceValue\n  if (failsafe > 0 && failsafe < debounceValue) {\n      failsafe = debounceValue + 50;\n  }\n\n  for (var i = 0; i < instances.length; i++) {\n    if (\n      instances[i].container === container &&\n      instances[i]._debounce === debounceValue &&\n      instances[i]._failsafe === failsafe\n    ) {\n      return instances[i].isInViewport(elt, offset, cb);\n    }\n  }\n\n  return instances[\n    instances.push(createInViewport(container, debounceValue, failsafe)) - 1\n  ].isInViewport(elt, offset, cb);\n}\n\nfunction addEvent(el, type, fn) {\n  if (el.attachEvent) {\n    el.attachEvent('on' + type, fn);\n  } else {\n    el.addEventListener(type, fn, false);\n  }\n}\n\nfunction debounce(func, wait, immediate) {\n  var timeout;\n  return function () {\n    var context = this, args = arguments;\n    var callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n\n    function later() {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    }\n  };\n}\n\n// https://github.com/jquery/sizzle/blob/3136f48b90e3edc84cbaaa6f6f7734ef03775a07/sizzle.js#L708\nvar contains = function() {\n  if (!global.document) {\n    return true;\n  }\n  return global.document.documentElement.compareDocumentPosition ?\n    function (a, b) {\n      return !!(a.compareDocumentPosition(b) & 16);\n    } :\n    global.document.documentElement.contains ?\n      function (a, b) {\n        return a !== b && ( a.contains ? a.contains(b) : false );\n      } :\n      function (a, b) {\n        while (b = b.parentNode) {\n          if (b === a) {\n            return true;\n          }\n        }\n        return false;\n      };\n}\n\nfunction createInViewport(container, debounceValue, failsafe) {\n  var watches = createWatches();\n\n  var scrollContainer = container === global.document.body ? global : container;\n  var debouncedCheck = debounce(watches.checkAll(watchInViewport), debounceValue);\n\n  addEvent(scrollContainer, 'scroll', debouncedCheck);\n\n  if (scrollContainer === global) {\n    addEvent(global, 'resize', debouncedCheck);\n  }\n\n  if (supportsMutationObserver) {\n    observeDOM(watches, container, debouncedCheck);\n  }\n\n  // failsafe check, every X we check for visible images\n  // usecase: a hidden parent containing eleements\n  // when the parent becomes visible, we have no event that the children\n  // became visible\n  if (failsafe > 0) {\n    setInterval(debouncedCheck, failsafe);\n  }\n\n  function isInViewport(elt, offset, cb) {\n    if (!cb) {\n      return isVisible(elt, offset);\n    }\n\n    var remote = createRemote(elt, offset, cb);\n    remote.watch();\n    return remote;\n  }\n\n  function createRemote(elt, offset, cb) {\n    function watch() {\n      watches.add(elt, offset, cb);\n    }\n\n    function dispose() {\n      watches.remove(elt);\n    }\n\n    return {\n      watch: watch,\n      dispose: dispose\n    };\n  }\n\n  function watchInViewport(elt, offset, cb) {\n    if (isVisible(elt, offset)) {\n      watches.remove(elt);\n      cb(elt);\n    }\n  }\n\n  function isVisible(elt, offset) {\n    if (!elt) {\n      return false;\n    }\n\n    if (!contains(global.document.documentElement, elt) || !contains(global.document.documentElement, container)) {\n      return false;\n    }\n\n    // Check if the element is visible\n    // https://github.com/jquery/jquery/blob/740e190223d19a114d5373758127285d14d6b71e/src/css/hiddenVisibleSelectors.js\n    if (!elt.offsetWidth || !elt.offsetHeight) {\n      return false;\n    }\n\n    var eltRect = elt.getBoundingClientRect();\n    var viewport = {};\n\n    if (container === global.document.body) {\n      viewport = {\n        top: -offset,\n        left: -offset,\n        right: global.document.documentElement.clientWidth + offset,\n        bottom: global.document.documentElement.clientHeight + offset\n      };\n    } else {\n      var containerRect = container.getBoundingClientRect();\n      viewport = {\n        top: containerRect.top - offset,\n        left: containerRect.left - offset,\n        right: containerRect.right + offset,\n        bottom: containerRect.bottom + offset\n      };\n    }\n\n    // The element must overlap with the visible part of the viewport\n    var visible =\n      (\n        eltRect.right >= viewport.left &&\n        eltRect.left <= viewport.right &&\n        eltRect.bottom >= viewport.top &&\n        eltRect.top <= viewport.bottom\n      );\n\n    return visible;\n  }\n\n  return {\n    container: container,\n    isInViewport: isInViewport,\n    _debounce: debounceValue,\n    _failsafe: failsafe\n  };\n}\n\nfunction createWatches() {\n  var watches = [];\n\n  function add(elt, offset, cb) {\n    if (!isWatched(elt)) {\n      watches.push([elt, offset, cb]);\n    }\n  }\n\n  function remove(elt) {\n    var pos = indexOf(elt);\n    if (pos !== -1) {\n      watches.splice(pos, 1);\n    }\n  }\n\n  function indexOf(elt) {\n    for (var i = watches.length - 1; i >= 0; i--) {\n      if (watches[i][0] === elt) {\n        return i;\n      }\n    }\n    return -1;\n  }\n\n  function isWatched(elt) {\n    return indexOf(elt) !== -1;\n  }\n\n  function checkAll(cb) {\n    return function () {\n      for (var i = watches.length - 1; i >= 0; i--) {\n        cb.apply(this, watches[i]);\n      }\n    };\n  }\n\n  return {\n    add: add,\n    remove: remove,\n    isWatched: isWatched,\n    checkAll: checkAll\n  };\n}\n\nfunction observeDOM(watches, container, cb) {\n  var observer = new MutationObserver(watch);\n  var filter = Array.prototype.filter;\n  var concat = Array.prototype.concat;\n\n  observer.observe(container, {\n    childList: true,\n    subtree: true,\n    // changes like style/width/height/display will be catched\n    attributes: true\n  });\n\n  function watch(mutations) {\n    // some new DOM nodes where previously watched\n    // we should check their positions\n    if (mutations.some(knownNodes) === true) {\n      setTimeout(cb, 0);\n    }\n  }\n\n  function knownNodes(mutation) {\n    var nodes = concat.call([],\n      Array.prototype.slice.call(mutation.addedNodes),\n      mutation.target\n    );\n    return filter.call(nodes, watches.isWatched).length > 0;\n  }\n}\n"],
  "mappings": "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",
  "names": []
}
